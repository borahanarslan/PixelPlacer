function createBackGroundCanvas(n,t){isGreenScreen=t;backVideo=document.createElement("video");backVideo.addEventListener("loadedmetadata",OnMetaData);backVideo.src=n;backVideo.width=640;backVideo.height=360;backVideo.loop=!0;backVideo.pause()}function OnMetaData(n){var i,t,e;backgroundParent=document.getElementById("vid-1");var f=backgroundParent.getBoundingClientRect().width,o=n.target.videoWidth,s=n.target.videoHeight,h=f/o;if(n.target.width=f,n.target.height=s*h,isGreenScreen==2){t=document.createElement("canvas");t.id="background-video";t.width=n.target.width;t.height=n.target.height;var r=new Seriously,c=r.source(backVideo),l=r.target(t),u=r.effect("chroma");u.source=c;i=r.transform("reformat");i.width=t.width;i.height=t.height;i.mode="distort";i.source=u;l.source=i;u.screen=[98/255,175/255,116/255,1];backgroundParent.appendChild(t);r.go();backVideo.play()}else t=document.createElement("canvas"),t.id="background-video",t.width=n.target.width,t.height=n.target.height,e=t.getContext("2d"),backgroundParent.appendChild(t),backVideo.addEventListener("play",function(){var i=this;(function n(){this.paused||this.ended||(e.drawImage(backVideo,0,0,t.width,t.height),setTimeout(n,1e3/30))})()}),backVideo.play()}function createCanvas(n,t){var i=document.createElement("video"),r,u;i.id="video-"+n;i.src=t;i.width=250;i.height=150;i.loop=!0;r=document.createElement("canvas");r.width=i.width;r.height=i.height;r.id="c-"+n;r.draggable=!0;r.ondragstart=drag;var f=new Seriously,o=f.source(i),s=f.target(r),e=f.effect("chroma");e.source=o;u=f.transform("reformat");u.width=250;u.height=150;u.mode="distort";u.source=e;s.source=u;e.screen=[98/255,175/255,116/255,1];document.getElementById(n).appendChild(r);f.go();i.play()}function allowDrop(n){n.preventDefault()}function drag(n){var t=n.target.getBoundingClientRect();xPos=n.clientX-t.left-window.scrollX;yPos=n.clientY-t.top-window.scrollY;n.dataTransfer.setData("text",n.target.id)}function drop(n){var e,t,u,f,i,r,c;n.preventDefault();e=n.dataTransfer.getData("text");t=document.getElementById(e);n.target.parentElement.appendChild(t);var o=document.getElementById("background-video"),s=n.clientX-o.getBoundingClientRect().left-window.scrollX,h=n.clientY-o.getBoundingClientRect().top-window.scrollY;for(t.style.position="absolute",t.style.left=s-xPos+"px",t.style.top=h-yPos+"px",canvasX=Math.floor(s-xPos),canvasY=Math.floor(h-yPos),u=t.id.replace("c-canvas-",""),f=!1,i=0;i<ProjectObject.ProjectClass.length;i++)r=ProjectObject.ProjectClass[i],r.ProjectVideosId==u&&(r.XPosition=canvasX,r.YPosition=canvasY,f=!0);f==!1&&(c={XPosition:canvasX,YPosition:canvasY,ProjectVideosId:u},ProjectObject.ProjectClass.push(c))}var xPos,yPos,canvasX,canvasY,backgroundParent,ProjectObject={},isGreenScreen,backVideo;ProjectObject.ProjectClass=[];$(document).ready(function(){$("#SaveButton").click(function(){var n=document.getElementById("ProjectTitle").value;ProjectObject.Title=n;$.ajax({url:"/Projects/SaveProject",type:"post",dataType:"json",data:ProjectObject,success:function(n){console.log("I'm awesome",n);window.location.href="/"}})})});